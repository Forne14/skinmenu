{% load wagtailcore_tags %}
{% load svg %}

{% with gs=settings.site_settings.GlobalSiteSettings nav=settings.site_settings.NavigationSettings brand=settings.site_settings.BrandAppearanceSettings %}
<footer class="border-t border-border/20 bg-surface pt-10 md:pt-12 pb-8">
  <div class="container-shell">

    {# ----------------------------- #}
    {# MOBILE FOOTER (below lg)      #}
    {# ----------------------------- #}
    <div class="lg:hidden px-4">

      {# Centered logo #}
      <div class="flex justify-center mb-8">
        {% if brand and brand.logo_light_path and brand.logo_dark_path %}
          <a href="/" class="inline-block no-underline" aria-label="{{ gs.clinic_name|default:'Home' }}">
            {% include "partials/brand/footer_logo.html" with brand=brand %}
          </a>
        {% else %}
          <div class="text-2xl font-display text-heading tracking-wide">
            {{ gs.clinic_name|default:"SKINMENU" }}
          </div>
        {% endif %}
      </div>

      {# Headings row (ensures perfect alignment) #}
      <div class="grid grid-cols-2 gap-x-10 mb-4">
        <div class="label-display text-skinmenu-brown">
          Links
        </div>
        <div class="label-display text-skinmenu-brown text-right">
          {{ gs.footer_find_us_heading|default:"Find us" }}
        </div>
      </div>

      {# Content row #}
      <div class="grid grid-cols-2 gap-x-10 items-start mb-10">

        {# LEFT: Links + socials #}
        <div>
          <nav class="flex flex-col gap-2 text-fg/70">
            {% for b in nav.footer_links %}
              {% with link=b.value %}
                {% if link.page %}
                  <a class="hover:text-skinmenu-brown transition-colors no-underline" href="{% pageurl link.page %}">{{ link.label }}</a>
                {% else %}
                  <a class="hover:text-skinmenu-brown transition-colors no-underline" href="{{ link.url }}"
                    {% if link.open_in_new_tab %}target="_blank" rel="noopener"{% endif %}
                  >{{ link.label }}</a>
                {% endif %}
              {% endwith %}
            {% endfor %}
          </nav>

          {# Socials (brand icons) - inherit currentColor => matches theme/button colors #}
          <div class="flex gap-4 pt-5">
            {% if gs.instagram_url %}
              <a
                href="{{ gs.instagram_url }}"
                class="inline-flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors no-underline"
                target="_blank"
                rel="noopener"
                aria-label="Instagram"
              >
                {% svg "icons/brands/instagram.svg" css_class="w-5 h-5" title="Instagram" %}
              </a>
            {% endif %}

            {% if gs.tiktok_url %}
              <a
                href="{{ gs.tiktok_url }}"
                class="inline-flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors no-underline"
                target="_blank"
                rel="noopener"
                aria-label="TikTok"
              >
                {% svg "icons/brands/tiktok.svg" css_class="w-5 h-5" title="TikTok" %}
              </a>
            {% endif %}

            {% if gs.facebook_url %}
              {# If you add icons/brands/facebook.svg, swap this to {% svg "icons/brands/facebook.svg" ... %} #}
              <a
                href="{{ gs.facebook_url }}"
                class="inline-flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors no-underline"
                target="_blank"
                rel="noopener"
                aria-label="Facebook"
              >
                <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="currentColor" d="M13.5 22v-8h2.7l.4-3H13.5V9.1c0-.9.3-1.6 1.7-1.6h1.5V4.7c-.3 0-1.3-.1-2.4-.1-2.4 0-4 1.4-4 4v2.4H8v3h2.3v8h3.2Z"/>
                </svg>
              </a>
            {% endif %}
          </div>
        </div>

        {# RIGHT: Find us + address #}
        <div class="text-right">
          {% if gs.address %}
            {% if gs.google_maps_url %}
              <a
                href="{{ gs.google_maps_url }}"
                class="block text-fg/60 whitespace-pre-line leading-relaxed no-underline hover:text-skinmenu-brown transition text-right"
                target="_blank"
                rel="noopener"
              >
                {{ gs.address }}
              </a>
            {% else %}
              <div class="text-fg/60 whitespace-pre-line leading-relaxed text-right">
                {{ gs.address }}
              </div>
            {% endif %}
          {% endif %}
        </div>

      </div>

      {# Optional map embed (full width on mobile) #}
      {% if gs.google_maps_embed_url %}
        <div class="mb-10">
          <div class="rounded-2xl overflow-hidden border border-border/20 bg-bg">
            <iframe
              title="Google Maps"
              src="{{ gs.google_maps_embed_url }}"
              class="w-full aspect-[4/3]"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              allowfullscreen
            ></iframe>
          </div>

          {% if gs.google_maps_url %}
            <div class="pt-2">
              <a href="{{ gs.google_maps_url }}" class="text-fg/50 hover:text-skinmenu-brown transition no-underline" target="_blank" rel="noopener">
                Open in Google Maps →
              </a>
            </div>
          {% endif %}
        </div>
      {% endif %}

      {# Newsletter (full width) #}
      <div class="mb-10">
        <div class="label-display text-skinmenu-brown mb-4 text-center">
          {{ gs.newsletter_heading|default:"Stay in the know" }}
        </div>

        <form
          {% if gs.newsletter_form_action %}
            action="{{ gs.newsletter_form_action }}"
            method="post"
            target="_blank"
          {% else %}
            action="#"
            method="post"
            onsubmit="return false;"
          {% endif %}
          class="space-y-4"
        >
          <input
            type="email"
            name="email"
            placeholder="Email Address"
            class="w-full bg-transparent border-b border-skinmenu-brown/20 py-2 text-heading outline-none focus:border-skinmenu-brown transition-colors placeholder:text-fg/40"
            required
            {% if not gs.newsletter_form_action %}disabled{% endif %}
          >

          <button
            type="submit"
            class="label-display text-fg/60 hover:text-skinmenu-brown transition-colors no-underline text-center"
            {% if not gs.newsletter_form_action %}disabled aria-disabled="true"{% endif %}
          >
            {{ gs.newsletter_button_label|default:"Subscribe" }}
          </button>

          {% if not gs.newsletter_form_action %}
            <p class="text-fg/50">
              Newsletter signup will be available shortly.
            </p>
          {% endif %}
        </form>
      </div>

    </div>

    {# ----------------------------- #}
    {# DESKTOP FOOTER (lg and up)    #}
    {# ----------------------------- #}
    <div class="hidden lg:block">

      <div class="grid gap-10 lg:grid-cols-12 mb-10 md:mb-12">

        {# Brand / address / socials / map #}
        <div class="lg:col-span-5 space-y-6">
          <div>
            {% if brand and brand.logo_light_path and brand.logo_dark_path %}
              <a href="/" class="inline-block no-underline" aria-label="{{ gs.clinic_name|default:'Home' }}">
                {% include "partials/brand/footer_logo.html" with brand=brand %}
              </a>
            {% else %}
              <h3 class="text-2xl font-display text-heading tracking-wide mb-3">
                {{ gs.clinic_name|default:"SKINMENU" }}
              </h3>
            {% endif %}

            {% if gs.address %}
              {% if gs.google_maps_url %}
                <a
                  href="{{ gs.google_maps_url }}"
                  class="block text-fg/60 whitespace-pre-line leading-relaxed mt-3 no-underline hover:text-skinmenu-brown transition"
                  target="_blank"
                  rel="noopener"
                >
                  {{ gs.address }}
                </a>
              {% else %}
                <div class="text-fg/60 whitespace-pre-line leading-relaxed mt-3">
                  {{ gs.address }}
                </div>
              {% endif %}
            {% endif %}
          </div>

          {# Socials (brand icons) #}
          <div class="flex gap-5 pt-1">
            {% if gs.instagram_url %}
              <a href="{{ gs.instagram_url }}" class="inline-flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors no-underline" target="_blank" rel="noopener" aria-label="Instagram">
                {% svg "icons/brands/instagram.svg" css_class="w-5 h-5" title="Instagram" %}
              </a>
            {% endif %}

            {% if gs.tiktok_url %}
              <a href="{{ gs.tiktok_url }}" class="inline-flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors no-underline" target="_blank" rel="noopener" aria-label="TikTok">
                {% svg "icons/brands/tiktok.svg" css_class="w-5 h-5" title="TikTok" %}
              </a>
            {% endif %}

            {% if gs.facebook_url %}
              <a href="{{ gs.facebook_url }}" class="inline-flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors no-underline" target="_blank" rel="noopener" aria-label="Facebook">
                <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="currentColor" d="M13.5 22v-8h2.7l.4-3H13.5V9.1c0-.9.3-1.6 1.7-1.6h1.5V4.7c-.3 0-1.3-.1-2.4-.1-2.4 0-4 1.4-4 4v2.4H8v3h2.3v8h3.2Z"/>
                </svg>
              </a>
            {% endif %}
          </div>

          {% if gs.google_maps_embed_url %}
            <div class="pt-2">
              <div class="rounded-2xl overflow-hidden border border-border/20 bg-bg">
                <iframe
                  title="Google Maps"
                  src="{{ gs.google_maps_embed_url }}"
                  class="w-full aspect-[4/3]"
                  loading="lazy"
                  referrerpolicy="no-referrer-when-downgrade"
                  allowfullscreen
                ></iframe>
              </div>

              {% if gs.google_maps_url %}
                <div class="pt-2">
                  <a href="{{ gs.google_maps_url }}" class="text-fg/50 hover:text-skinmenu-brown transition no-underline" target="_blank" rel="noopener">
                    Open in Google Maps →
                  </a>
                </div>
              {% endif %}
            </div>
          {% endif %}
        </div>

        {# Footer links #}
        <div class="lg:col-span-3">
          <div class="label-display text-skinmenu-brown mb-4">
            Links
          </div>

          <nav class="flex flex-col gap-2 text-fg/70">
            {% for b in nav.footer_links %}
              {% with link=b.value %}
                {% if link.page %}
                  <a class="hover:text-skinmenu-brown transition-colors no-underline" href="{% pageurl link.page %}">{{ link.label }}</a>
                {% else %}
                  <a class="hover:text-skinmenu-brown transition-colors no-underline" href="{{ link.url }}"
                    {% if link.open_in_new_tab %}target="_blank" rel="noopener"{% endif %}
                  >{{ link.label }}</a>
                {% endif %}
              {% endwith %}
            {% endfor %}
          </nav>
        </div>

        {# Newsletter #}
        <div class="lg:col-span-4">
          <div class="label-display text-skinmenu-brown mb-4">
            {{ gs.newsletter_heading|default:"Stay in the know" }}
          </div>

          <form
            {% if gs.newsletter_form_action %}
              action="{{ gs.newsletter_form_action }}"
              method="post"
              target="_blank"
            {% else %}
              action="#"
              method="post"
              onsubmit="return false;"
            {% endif %}
            class="space-y-4"
          >
            <input
              type="email"
              name="email"
              placeholder="Email Address"
              class="w-full bg-transparent border-b border-skinmenu-brown/20 py-2 text-heading outline-none focus:border-skinmenu-brown transition-colors placeholder:text-fg/40"
              required
              {% if not gs.newsletter_form_action %}disabled{% endif %}
            >

            <button
              type="submit"
              class="label-display text-fg/60 hover:text-skinmenu-brown transition-colors no-underline"
              {% if not gs.newsletter_form_action %}disabled aria-disabled="true"{% endif %}
            >
              {{ gs.newsletter_button_label|default:"Subscribe" }}
            </button>

            {% if not gs.newsletter_form_action %}
              <p class="text-fg/50">
                Newsletter signup will be available shortly.
              </p>
            {% endif %}
          </form>
        </div>

      </div>
    </div>

    {# Bottom bar #}
    <div class="border-t border-border/10 pt-6 flex flex-col md:flex-row justify-between items-center gap-5">
      <div class="text-fg/40">
        &copy; {% now "Y" %} {{ gs.clinic_name|default:"SKINMENU" }}. All rights reserved.
      </div>

      <div class="flex items-center gap-8">
        <div class="flex gap-4 text-fg/40">
          <a href="/privacy/" class="hover:text-fg transition no-underline">Privacy</a>
          <a href="/terms/" class="hover:text-fg transition no-underline">Terms</a>
        </div>

        <button
          type="button"
          class="theme-toggle flex items-center justify-center text-fg/60 hover:text-skinmenu-brown transition-colors p-2 rounded-full border border-transparent hover:border-skinmenu-brown/10"
          aria-label="Toggle theme"
          data-theme-toggle
        >
          <div class="relative w-6 h-6">
            <svg class="theme-icon theme-icon-sun absolute inset-0 w-full h-full" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364-6.364-1.414 1.414M7.05 16.95l-1.414 1.414M18.364 18.364l-1.414-1.414M7.05 7.05 5.636 5.636M16 12a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/>
            </svg>
            <svg class="theme-icon theme-icon-moon absolute inset-0 w-full h-full" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                d="M21 12.8A7.2 7.2 0 1 1 11.2 3a5.6 5.6 0 0 0 9.8 9.8Z"/>
            </svg>
          </div>
        </button>
      </div>
    </div>

  </div>
</footer>
{% endwith %}
