{% load wagtailcore_tags %}

<section class="section">
  <div class="container-shell">
    <div class="flex items-end justify-between gap-6">
      <div class="max-w-2xl">
        {% if block.value.heading %}
          <h2 class="section-title">
            {{ block.value.heading }}
          </h2>
        {% endif %}

        {% if block.value.intro %}
          <p class="mt-2 text-muted">
            {{ block.value.intro }}
          </p>
        {% endif %}
      </div>

      {% if block.value.cta_page %}
        <div class="hidden md:block">
          <a href="{% pageurl block.value.cta_page %}" class="btn btn-ghost">
            {{ block.value.cta_label|default:"See full menu" }}
          </a>
        </div>
      {% endif %}
    </div>

    <div class="mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {# Legacy: featured_pages may contain missing references after dev reseeds #}
      {% for p in block.value.featured_pages %}
        {% if p %}
          <a href="{% pageurl p %}" class="card p-6 hover:border-border/70 transition no-underline">
            <div class="flex items-center justify-between gap-4">
              <h3 class="text-heading">{{ p.title }}</h3>
              <span class="text-muted">â†’</span>
            </div>
            {% if p.search_description %}
              <p class="mt-2 text-muted">{{ p.search_description }}</p>
            {% endif %}
          </a>
        {% endif %}
      {% empty %}
        <div class="card p-6">
          <p class="text-muted">
            No featured pages selected yet. Edit the homepage and choose pages to feature.
          </p>
        </div>
      {% endfor %}
    </div>

    {% if block.value.cta_page %}
      <div class="mt-8 md:hidden">
        <a href="{% pageurl block.value.cta_page %}" class="btn btn-ghost w-full">
          {{ block.value.cta_label|default:"See full menu" }}
        </a>
      </div>
    {% endif %}
  </div>
</section>
